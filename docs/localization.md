# Localization Guide

This document provides guidelines for contributing translations and localization to the xlsx2md project.

## Overview

Currently, xlsx2md is designed as an English-first project. All user-facing messages, documentation, and examples are in English. However, we welcome contributions for localization if there's community demand.

## Current Localization Status

- **Primary Language**: English
- **Documentation**: English only
- **CLI Messages**: English only
- **Error Messages**: English only
- **Examples**: English only
- **Code Comments**: English only

## Localization Strategy

### Phase 1: Preparation (Current)
- ✅ All strings are externalized and use consistent formatting
- ✅ Error messages are centralized in `config.py`
- ✅ Documentation structure supports multiple languages
- ✅ CLI help messages are generated by Typer (supports localization)

### Phase 2: Translation Infrastructure (Future)
- [ ] Implement gettext for string extraction
- [ ] Create translation files structure
- [ ] Add language detection and selection
- [ ] Update CLI to support `--lang` parameter

### Phase 3: Community Translations (Future)
- [ ] Accept translation contributions
- [ ] Review and validate translations
- [ ] Maintain translation quality
- [ ] Regular translation updates

## Contributing Translations

### Prerequisites

1. **Language Proficiency**: Native or near-native proficiency in the target language
2. **Technical Knowledge**: Understanding of CLI tools and file formats
3. **Context Awareness**: Familiarity with Excel, CSV, and Markdown concepts

### Translation Guidelines

#### 1. **CLI Messages**
- Keep technical terms consistent
- Maintain command-line formatting
- Preserve parameter names and syntax
- Use appropriate formal/informal tone for the language

#### 2. **Error Messages**
- Be clear and actionable
- Include technical details when relevant
- Use consistent terminology
- Maintain error codes and formatting

#### 3. **Documentation**
- Translate examples with appropriate cultural context
- Maintain code examples in English
- Update links and references
- Consider local formatting conventions

#### 4. **Examples**
- Use culturally appropriate sample data
- Maintain file format compatibility
- Consider local date/time formats
- Use appropriate character encodings

### Translation Process

1. **Fork the Repository**
   ```bash
   git clone https://github.com/your-username/xlsx2md.git
   cd xlsx2md
   ```

2. **Create Translation Branch**
   ```bash
   git checkout -b feature/localization-[language-code]
   ```

3. **Identify Strings to Translate**
   - CLI help messages
   - Error messages in `config.py`
   - Documentation files
   - Example files

4. **Create Translation Files**
   ```
   docs/
   ├── localization/
   │   ├── ru/
   │   │   ├── README.md
   │   │   ├── api.md
   │   │   └── examples/
   │   ├── es/
   │   │   ├── README.md
   │   │   └── ...
   │   └── ...
   ```

5. **Submit Pull Request**
   - Include language code in PR title
   - Add translation notes
   - Request review from native speakers

### Supported Languages

#### Priority 1 (High Demand)
- [ ] Russian (ru)
- [ ] Spanish (es)
- [ ] French (fr)
- [ ] German (de)
- [ ] Chinese (zh)

#### Priority 2 (Medium Demand)
- [ ] Japanese (ja)
- [ ] Korean (ko)
- [ ] Portuguese (pt)
- [ ] Italian (it)
- [ ] Dutch (nl)

#### Priority 3 (Low Demand)
- [ ] Other languages based on community requests

## Technical Implementation

### String Externalization

Current error messages are centralized in `config.py`:

```python
ERROR_MESSAGES = {
    "file_not_found": "File not found: {file_path}",
    "unsupported_format": "Unsupported file format: {format}. Supported formats: {supported}",
    # ... more messages
}
```

### Future gettext Implementation

```python
import gettext

# Load translations
gettext.install('xlsx2md', localedir='locale')

def get_error_message(key: str, **kwargs) -> str:
    """Get localized error message."""
    message = gettext.gettext(ERROR_MESSAGES[key])
    return message.format(**kwargs)
```

### CLI Language Support

Future CLI implementation:

```python
@app.command()
def main(
    file_path: str,
    lang: Optional[str] = typer.Option(None, "--lang", help="Language for output"),
    # ... other options
):
    """Convert Excel files to Markdown tables."""
    if lang:
        set_language(lang)
    # ... rest of implementation
```

## Quality Assurance

### Translation Review Process

1. **Automated Checks**
   - [ ] String completeness
   - [ ] Format consistency
   - [ ] Character encoding validation

2. **Manual Review**
   - [ ] Native speaker review
   - [ ] Technical accuracy
   - [ ] Cultural appropriateness
   - [ ] Consistency with existing translations

3. **Testing**
   - [ ] CLI functionality in target language
   - [ ] Error message display
   - [ ] Documentation rendering
   - [ ] Example file compatibility

### Translation Standards

#### Terminology
- **Excel**: Use official localized terms when available
- **CSV**: Maintain technical accuracy
- **Markdown**: Use established translations
- **CLI**: Follow platform conventions

#### Formatting
- **Dates**: Use local date formats
- **Numbers**: Use local number formatting
- **Currency**: Use appropriate currency symbols
- **Encoding**: Ensure UTF-8 compatibility

## Maintenance

### Regular Updates
- Sync translations with new features
- Update example files for new formats
- Review and update documentation
- Maintain translation quality

### Community Involvement
- Encourage native speaker contributions
- Provide translation guidelines
- Review and merge translations promptly
- Acknowledge translation contributors

## Resources

### Translation Tools
- [gettext](https://www.gnu.org/software/gettext/) - Internationalization framework
- [Poedit](https://poedit.net/) - Translation editor
- [Crowdin](https://crowdin.com/) - Translation management platform

### Style Guides
- [Microsoft Style Guide](https://docs.microsoft.com/en-us/style-guide/)
- [Google Style Guide](https://developers.google.com/style)
- [Apple Style Guide](https://developer.apple.com/design/human-interface-guidelines/)

### Community
- [GitHub Discussions](https://github.com/postovalov/xlsx2md/discussions)
- [Translation Issues](https://github.com/postovalov/xlsx2md/issues?q=label%3Alocalization)
- [Contributor Guidelines](CONTRIBUTING.md)

## Contact

For translation-related questions or contributions:

- **Issues**: [GitHub Issues](https://github.com/postovalov/xlsx2md/issues)
- **Discussions**: [GitHub Discussions](https://github.com/postovalov/xlsx2md/discussions)
- **Email**: rpostovalov@gmail.com

---

**Note**: This localization guide is a living document. It will be updated as the project evolves and community needs change.
